# ä¸œæ–¹å¼¹å¹•åœ°ç‹± - æŠ€æœ¯æ–‡æ¡£

## ğŸ“ æ–‡ä»¶æ¶æ„

```
Touhou_Bullet_Hell/
â”œâ”€â”€ index.html          # æ¸¸æˆä¸»é¡µé¢ï¼ŒåŒ…å«HTMLç»“æ„å’ŒCSSæ ·å¼
â”œâ”€â”€ game.js             # æ¸¸æˆæ ¸å¿ƒé€»è¾‘ï¼ŒåŒ…å«æ‰€æœ‰ç±»å’Œå‡½æ•°
â”œâ”€â”€ README.md           # æ¸¸æˆè¯´æ˜æ–‡æ¡£
â””â”€â”€ GameDocumentation.md # æŠ€æœ¯æ–‡æ¡£ (æœ¬æ–‡ä»¶)
```

## ğŸ® æ¸¸æˆæ¶æ„æ¦‚è§ˆ

### ä¸»è¦ç»„ä»¶
- **HTMLç•Œé¢å±‚**: æ¸¸æˆUIå’ŒCanvaså®¹å™¨
- **æ¸¸æˆå¼•æ“å±‚**: æ¸¸æˆå¾ªç¯ã€æ¸²æŸ“ã€æ›´æ–°é€»è¾‘
- **æ¸¸æˆå¯¹è±¡å±‚**: ç©å®¶ã€æ•Œäººã€å­å¼¹ã€ç²’å­ç­‰å®ä½“
- **ç³»ç»Ÿç®¡ç†å±‚**: çŠ¶æ€ç®¡ç†ã€è¾“å…¥å¤„ç†ã€ç¢°æ’æ£€æµ‹

## ğŸ“Š æ ¸å¿ƒæ•°æ®ç»“æ„

### 1. æ¸¸æˆé…ç½® (CONFIG)
```javascript
const CONFIG = {
    PLAYER_SPEED: 6,           // ç©å®¶ç§»åŠ¨é€Ÿåº¦
    BULLET_SPEED: 10,          // ç©å®¶å­å¼¹é€Ÿåº¦
    ENEMY_BULLET_SPEED: 1.5,   // æ•Œäººå¼¹å¹•é€Ÿåº¦
    ENEMY_SPAWN_RATE: 0.05,    // æ•Œäººç”Ÿæˆé¢‘ç‡
    BULLET_COOLDOWN: 5         // å°„å‡»å†·å´æ—¶é—´
};
```

### 2. æ¸¸æˆçŠ¶æ€ (gameState)
```javascript
let gameState = {
    isRunning: false,          // æ¸¸æˆè¿è¡ŒçŠ¶æ€
    isPaused: false,           // æš‚åœçŠ¶æ€
    score: 0,                  // å½“å‰åˆ†æ•°
    stage: 1,                  // å½“å‰å…³å¡
    maxStage: 10,              // æœ€å¤§å…³å¡æ•°
    kills: 0,                  // æ€»å‡»æ€æ•°
    stageKills: 0,             // æœ¬å…³å‡»æ€æ•°
    stageTarget: 50,           // æœ¬å…³ç›®æ ‡å‡»æ€æ•°
    showStageComplete: false,  // æ˜¯å¦æ˜¾ç¤ºå…³å¡å®Œæˆ
    lastHealthBuyScore: 0      // ä¸Šæ¬¡è´­ä¹°è¡€é‡æ—¶çš„åˆ†æ•°
};
```

### 3. ç©å®¶å‡çº§æ•°æ® (playerUpgrades)
```javascript
let playerUpgrades = {
    power: 1,          // ç«åŠ›ç­‰çº§ (1-5)
    speed: 1,          // ç§»åŠ¨é€Ÿåº¦å€æ•°
    health: 5,         // å½“å‰è¡€é‡
    maxHealth: 5       // æœ€å¤§è¡€é‡
};
```

## ğŸ¯ ç±»ç»“æ„ä¸äº¤äº’

### 1. Player ç±»
**èŒè´£**: ç©å®¶è§’è‰²çš„è¡Œä¸ºå’Œæ¸²æŸ“

#### å±æ€§
```javascript
class Player {
    constructor(x, y) {
        this.x = x;                    // Xåæ ‡
        this.y = y;                    // Yåæ ‡
        this.width = 20;               // å®½åº¦
        this.height = 20;              // é«˜åº¦
        this.color = '#00ff00';        // é¢œè‰²
        this.hitboxRadius = 3;         // ç¢°æ’åŠå¾„
        this.invulnerable = 0;         // æ— æ•Œæ—¶é—´
    }
}
```

#### æ ¸å¿ƒæ–¹æ³•
- `update()`: å¤„ç†ç§»åŠ¨å’Œå°„å‡»é€»è¾‘
- `draw()`: æ¸²æŸ“ç©å®¶é£æœºå’Œç‰¹æ•ˆ
- `takeDamage()`: å¤„ç†å—ä¼¤é€»è¾‘

#### å°„å‡»ç³»ç»Ÿ
æ ¹æ®Powerç­‰çº§å‘å°„ä¸åŒæ•°é‡å’Œè§’åº¦çš„å­å¼¹ï¼š
- Power 1: å•å‘ç›´å°„
- Power 2: åŒå‘å¹¶è¡Œ
- Power 3-5: æ‰‡å½¢å¤šå‘

### 2. Enemy ç±»
**èŒè´£**: æ•Œäººçš„AIè¡Œä¸ºã€ç§»åŠ¨æ¨¡å¼å’Œæ”»å‡»

#### æ•Œäººç±»å‹ç³»ç»Ÿ
```javascript
setupByType(type) {
    switch(type) {
        case 'normal':   // æ™®é€šæ•Œäºº
        case 'fast':     // å¿«é€Ÿæ•Œäºº
        case 'heavy':    // é‡å‹æ•Œäºº
        case 'sniper':   // ç‹™å‡»æ‰‹
        case 'bomber':   // è½°ç‚¸æœº
        case 'boss':     // Boss
    }
}
```

#### ç§»åŠ¨æ¨¡å¼
- `linear`: ç›´çº¿ç§»åŠ¨
- `sine`: æ­£å¼¦æ³¢ç§»åŠ¨
- `zigzag`: Zå­—å½¢ç§»åŠ¨
- `circle`: åœ†å½¢ç§»åŠ¨
- `hover`: æ‚¬åœæ¨¡å¼
- `boss`: Bossç‰¹æ®Šç§»åŠ¨

#### å°„å‡»æ¨¡å¼
- æ™®é€šå°„å‡»: è¿½è¸ªç©å®¶
- æ•£å°„å°„å‡»: å¤šå‘æ•£å°„
- ç¯å½¢å°„å‡»: 360åº¦ç¯å½¢å¼¹å¹•
- Bosså¼¹å¹•: æ—‹è½¬å¼¹å¹•

### 3. PlayerBullet ç±»
**èŒè´£**: ç©å®¶å­å¼¹çš„ç‰©ç†å’Œæ¸²æŸ“

```javascript
class PlayerBullet {
    constructor(x, y, angle = 0) {
        this.x = x;
        this.y = y;
        this.angle = angle;            // å‘å°„è§’åº¦
        this.vx = Math.sin(angle) * this.speed;
        this.vy = -Math.cos(angle) * this.speed;
        this.damage = playerUpgrades.power;  // ä¼¤å®³=Powerç­‰çº§
    }
}
```

### 4. EnemyBullet ç±»
**èŒè´£**: æ•Œäººå¼¹å¹•çš„è¡Œä¸ºå’Œè§†è§‰æ•ˆæœ

#### å¼¹å¹•ç±»å‹
- `normal`: æ™®é€šå¼¹å¹•
- `circle`: åœ†å½¢å¼¹å¹•
- `heavy`: é‡å‹å¼¹å¹•
- `sniper`: ç‹™å‡»å¼¹å¹•
- `bomb`: çˆ†ç‚¸å¼¹å¹•
- `fast`: å¿«é€Ÿå¼¹å¹•

### 5. Particle ç±»
**èŒè´£**: çˆ†ç‚¸å’Œç‰¹æ•ˆç²’å­

```javascript
class Particle {
    constructor(x, y) {
        this.vx = (Math.random() - 0.5) * 8;  // éšæœºé€Ÿåº¦
        this.vy = (Math.random() - 0.5) * 8;
        this.life = 60;                        // ç”Ÿå‘½å‘¨æœŸ
        this.color = `hsl(${Math.random() * 60 + 20}, 100%, 50%)`;
    }
}
```

## ğŸ”„ æ¸¸æˆå¾ªç¯ç³»ç»Ÿ

### ä¸»å¾ªç¯ (gameLoop)
```javascript
function gameLoop() {
    updateGame();    // æ›´æ–°æ¸¸æˆé€»è¾‘
    renderGame();    // æ¸²æŸ“æ¸¸æˆç”»é¢
    requestAnimationFrame(gameLoop);  // é€’å½’è°ƒç”¨
}
```

### æ›´æ–°æµç¨‹ (updateGame)
1. æ›´æ–°ç©å®¶çŠ¶æ€
2. æ›´æ–°æ‰€æœ‰å­å¼¹
3. æ›´æ–°æ‰€æœ‰æ•Œäºº
4. æ›´æ–°ç²’å­æ•ˆæœ
5. ç”Ÿæˆæ–°æ•Œäºº
6. ç¢°æ’æ£€æµ‹
7. æ£€æŸ¥å…³å¡å®Œæˆ
8. æ›´æ–°UIæ˜¾ç¤º

### æ¸²æŸ“æµç¨‹ (renderGame)
1. æ¸…ç©ºç”»å¸ƒ
2. ç»˜åˆ¶èƒŒæ™¯æ˜Ÿç©º
3. ç»˜åˆ¶æ‰€æœ‰æ¸¸æˆå¯¹è±¡
4. ç»˜åˆ¶UIç•Œé¢
5. ç»˜åˆ¶ç‰¹æ®Šæ•ˆæœ

## âš”ï¸ ç¢°æ’æ£€æµ‹ç³»ç»Ÿ

### ç¢°æ’å‡½æ•°
```javascript
function checkCollision(obj1, obj2, radius1, radius2) {
    const dx = obj1.x - obj2.x;
    const dy = obj1.y - obj2.y;
    const distance = Math.sqrt(dx * dx + dy * dy);
    return distance < radius1 + radius2;
}
```

### ç¢°æ’ç±»å‹
1. **ç©å®¶å­å¼¹ vs æ•Œäºº**: é€ æˆä¼¤å®³ï¼Œè·å¾—åˆ†æ•°
2. **æ•Œäººå­å¼¹ vs ç©å®¶**: æ‰£é™¤è¡€é‡ï¼Œè§¦å‘æ— æ•Œæ—¶é—´
3. **æ•Œäºº vs ç©å®¶**: ç›´æ¥æ‰£é™¤è¡€é‡

## ğŸ® è¾“å…¥å¤„ç†ç³»ç»Ÿ

### é”®ç›˜æ˜ å°„
```javascript
const keys = {};  // é”®ç›˜çŠ¶æ€å­˜å‚¨

// äº‹ä»¶ç›‘å¬
document.addEventListener('keydown', (e) => {
    keys[e.key] = true;
    // ç‰¹æ®Šé”®å¤„ç†
    if (e.key === 'Escape') // æš‚åœ
    if (e.key === 'Enter')  // ä¸‹ä¸€å…³
});
```

### æ”¯æŒçš„è¾“å…¥
- `WASD` / `æ–¹å‘é”®`: ç§»åŠ¨
- `ç©ºæ ¼é”®`: å°„å‡»
- `ESC`: æš‚åœ/ç»§ç»­
- `Enter`: ç¡®è®¤/ä¸‹ä¸€å…³

## ğŸ¯ æ¸¸æˆæœºåˆ¶ç³»ç»Ÿ

### 1. Powerå‡çº§ç³»ç»Ÿ
```javascript
giveKillReward() {
    if (gameState.kills % 5 === 0) {
        if (playerUpgrades.power < 5) {
            playerUpgrades.power++;
        }
    }
}
```

### 2. è¡€é‡è´­ä¹°ç³»ç»Ÿ
```javascript
checkHealthPurchase() {
    const scoreGap = gameState.score - gameState.lastHealthBuyScore;
    if (scoreGap >= 3000 && playerUpgrades.maxHealth < 10) {
        playerUpgrades.health++;
        playerUpgrades.maxHealth++;
    }
}
```

### 3. å…³å¡è¿›åº¦ç³»ç»Ÿ
- æ¯å…³éœ€è¦å‡»æ€æŒ‡å®šæ•°é‡æ•Œäºº
- å…³å¡1: 50ä¸ªæ•Œäºº
- å…³å¡2: 65ä¸ªæ•Œäºº (+15)
- å…³å¡3: 80ä¸ªæ•Œäºº (+15)
- ä»¥æ­¤ç±»æ¨...

### 4. æ•Œäººç”Ÿæˆç³»ç»Ÿ
```javascript
function spawnEnemy() {
    // åŸºäºå…³å¡çš„éš¾åº¦é€’å¢
    const stageMultiplier = 1 + (gameState.stage - 1) * 0.3;
    const spawnRate = CONFIG.ENEMY_SPAWN_RATE * stageMultiplier;
    
    // æ•Œäººç±»å‹æ¦‚ç‡åˆ†å¸ƒ
    // Boss: 3-8%
    // ç‰¹æ®Šæ•Œäºº: 15-45%
    // æ™®é€šæ•Œäºº: å‰©ä½™æ¦‚ç‡
}
```

## ğŸ¨ æ¸²æŸ“ç³»ç»Ÿ

### Canvasæ¸²æŸ“ç®¡çº¿
1. **èƒŒæ™¯å±‚**: æ¸å˜èƒŒæ™¯ + æ˜Ÿç©ºåŠ¨ç”»
2. **æ¸¸æˆå¯¹è±¡å±‚**: ç©å®¶ã€æ•Œäººã€å­å¼¹
3. **ç²’å­å±‚**: çˆ†ç‚¸æ•ˆæœã€ç‰¹æ•ˆ
4. **UIå±‚**: åˆ†æ•°ã€è¡€é‡ã€çŠ¶æ€ä¿¡æ¯
5. **è¦†ç›–å±‚**: æš‚åœã€å…³å¡å®Œæˆç•Œé¢

### è§†è§‰æ•ˆæœ
- **å‘å…‰æ•ˆæœ**: `shadowBlur` å’Œ `shadowColor`
- **é€æ˜åº¦**: å—ä¼¤é—ªçƒã€ç²’å­æ·¡å‡º
- **é¢œè‰²ç¼–ç **: ä¸åŒæ•Œäººç±»å‹ç”¨ä¸åŒé¢œè‰²åŒºåˆ†
- **åŠ¨æ€UI**: è¡€é‡æ¡é¢œè‰²å˜åŒ–

## ğŸ”§ æ€§èƒ½ä¼˜åŒ–

### å¯¹è±¡æ± ç®¡ç†
- è‡ªåŠ¨æ¸…ç†å±å¹•å¤–çš„å­å¼¹
- é™åˆ¶ç²’å­æ•°é‡å’Œç”Ÿå‘½å‘¨æœŸ
- æ•Œäººç”Ÿå‘½å‘¨æœŸç®¡ç†

### æ¸²æŸ“ä¼˜åŒ–
- åªç»˜åˆ¶å¯è§åŒºåŸŸå†…çš„å¯¹è±¡
- ä½¿ç”¨ `requestAnimationFrame` å®ç°æµç•…åŠ¨ç”»
- åˆç†ä½¿ç”¨Canvas APIé¿å…æ€§èƒ½æŸå¤±

## ğŸµ æ‰©å±•æ€§è®¾è®¡

### æ˜“äºæ‰©å±•çš„éƒ¨åˆ†
1. **æ–°æ•Œäººç±»å‹**: åœ¨ `Enemy.setupByType()` ä¸­æ·»åŠ 
2. **æ–°å¼¹å¹•æ¨¡å¼**: åœ¨ `Enemy.shoot()` ä¸­æ‰©å±•
3. **æ–°Poweræ•ˆæœ**: åœ¨ `Player.update()` ä¸­ä¿®æ”¹å°„å‡»é€»è¾‘
4. **æ–°å…³å¡æœºåˆ¶**: ä¿®æ”¹ `nextStage()` å‡½æ•°

### æ¨¡å—åŒ–è®¾è®¡
- é…ç½®ä¸é€»è¾‘åˆ†ç¦»
- æ¸²æŸ“ä¸æ›´æ–°åˆ†ç¦»
- è¾“å…¥å¤„ç†ç‹¬ç«‹
- çŠ¶æ€ç®¡ç†é›†ä¸­

## ğŸ“ˆ æ•°æ®æµå›¾

```
ç”¨æˆ·è¾“å…¥ â†’ è¾“å…¥å¤„ç† â†’ æ¸¸æˆçŠ¶æ€æ›´æ–° â†’ å¯¹è±¡æ›´æ–° â†’ ç¢°æ’æ£€æµ‹ â†’ æ¸²æŸ“æ˜¾ç¤º
    â†‘                                                                    â†“
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ¸¸æˆå¾ªç¯ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› è°ƒè¯•å’Œæµ‹è¯•

### è°ƒè¯•åŠŸèƒ½
- ç©å®¶ç¢°æ’ç®±å¯è§†åŒ– (çº¢è‰²åœ†åœˆ)
- æ§åˆ¶å°è¾“å‡ºå…³é”®äº‹ä»¶
- åˆ†æ­¥è°ƒè¯•æ”¯æŒ

### æµ‹è¯•è¦ç‚¹
1. å„ç§æµè§ˆå™¨å…¼å®¹æ€§
2. ä¸åŒå±å¹•åˆ†è¾¨ç‡é€‚é…
3. é•¿æ—¶é—´æ¸¸æˆçš„å†…å­˜ç®¡ç†
4. æç«¯æƒ…å†µä¸‹çš„æ¸¸æˆçŠ¶æ€

---

ğŸ“ **æœ¬æŠ€æœ¯æ–‡æ¡£è¯¦ç»†æè¿°äº†æ¸¸æˆçš„å®Œæ•´å®ç°æ¶æ„ï¼Œä¸ºåç»­å¼€å‘å’Œç»´æŠ¤æä¾›å‚è€ƒã€‚** 